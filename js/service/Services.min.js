SDM.angular.factory("InitService",["$document","sharedProperties",function(a,b){"use strict";function e(){var c,a=SDM.fw7;for(a.views.push(a.app.addView(".view-main",a.options)),c=0;c<d.ready.length;c+=1)d.ready[c]();document.addEventListener("backbutton",function(c){var d=a.app.getCurrentView().activePage;if(a.app.hidePreloader(),"Home"==d.name){c.preventDefault();var e=function(a){1==a&&(navigator.app.clearHistory(),navigator.app.exitApp())};navigator.notification.confirm("Voulez-vous quitter l'application?",e,"Quitter?",["OK","Annuler"])}else if("Departement"==d.name)b.setbuttonDep(0),a.app.mainView.router.back();else if("index"==d.name){var f=localStorage.getItem("departement"),g=localStorage.getItem("region");b.setbuttonFav(0),b.setbuttonNew(0),b.setbuttonSearch(0),b.sethomevar(0),b.setfiltreFav("0"),b.setfiltreNew(""),b.setshowSearch("0");var h=SDM.fw7.app.searchbar(".searchbar",{searchList:".list-block-search",searchIn:".item-title"});h.clear();var i=document.querySelector(".navbar-fixed .page>.searchbar~.page-content, .navbar-fixed>.searchbar~.page-content, .navbar-through .page>.searchbar~.page-content, .navbar-through>.searchbar~.page-content");i.style.padding="60px 0",""!=f&&null!=f?(b.setInfoDep("dans le "+f),b.setLocalisation(f)):""!=g&&null!=g?(b.setInfoDep("dans votre région"),b.setLocalisation(g)):(b.setInfoDep(""),b.setdisplay_limit(25)),a.app.mainView.router.loadPage("#Home")}else a.app.mainView.router.back()},!1)}var c={},d={ready:[]};return c.addEventListener=function(a,b){d[a].push(b)},SDM.fw7.app.showIndicator(),function(){a.ready(function(){document.URL.indexOf("http://")===-1&&document.URL.indexOf("https://")===-1?document.addEventListener("deviceready",e,!1):e()})}(),c}]),SDM.angular.service("sharedProperties",function(){var a="",b="",c="",d="",e="",f="",g="0",h="Concerts",i="",j=0,k="0",l="",m="0",n=buttonFav=buttonSearch=buttonDep=homevar=0,o=Info=LocalDepartement=name="",p=ArrayB=ArrayC=ArrayD=ArrayE=ArrayF=ArrayG=ArrayH=ArrayI=ArrayJ=ArrayK=ArrayL=ArrayM=ArrayN=ArrayO=ArrayP=ArrayQ=ArrayR=ArrayS=ArrayT=ArrayU=ArrayV=ArrayW=ArrayX=ArrayY=ArrayZ=Array0="";return{getCountFav:function(){return a},setCountFav:function(b){a=b},getCountNew:function(){return b},setCountNew:function(a){b=a},getCountConcert:function(){return c},setCountConcert:function(a){c=a},getCountFiltre:function(){return d},setCountFiltre:function(a){d=a},getConcerts:function(){return e},setConcerts:function(a){e=a},getpreload:function(){return f},setpreload:function(a){f=a},getfiltreFav:function(){return g},setfiltreFav:function(a){g=a},getTITRE:function(){return h},setTITRE:function(a){h=a},getLocalisation:function(){return i},setLocalisation:function(a){i=a},getdisplay_limit:function(){return j},setdisplay_limit:function(a){j=a},getfiltreNew:function(){return k},setfiltreNew:function(a){k=a},getInfoDep:function(){return l},setInfoDep:function(a){l=a},getshowSearch:function(){return m},setshowSearch:function(a){m=a},getbuttonNew:function(){return n},setbuttonNew:function(a){n=a},getbuttonFav:function(){return buttonFav},setbuttonFav:function(a){buttonFav=a},getbuttonSearch:function(){return buttonSearch},setbuttonSearch:function(a){buttonSearch=a},getbuttonDep:function(){return buttonDep},setbuttonDep:function(a){buttonDep=a},gethomevar:function(){return homevar},sethomevar:function(a){homevar=a},getfiltreRegion:function(){return o},setfiltreRegion:function(a){o=a},getInfo:function(){return Info},setInfo:function(a){Info=a},getLocalDepartement:function(){return LocalDepartement},setLocalDepartement:function(a){LocalDepartement=a},getname:function(){return name},setname:function(a){name=a},getArrayA:function(){return p},setArrayA:function(a){p=a},getArrayB:function(){return ArrayB},setArrayB:function(a){ArrayB=a},getArrayC:function(){return ArrayC},setArrayC:function(a){ArrayC=a},getArrayD:function(){return ArrayD},setArrayD:function(a){ArrayD=a},getArrayE:function(){return ArrayE},setArrayE:function(a){ArrayE=a},getArrayF:function(){return ArrayF},setArrayF:function(a){ArrayF=a},getArrayG:function(){return ArrayG},setArrayG:function(a){ArrayG=a},getArrayH:function(){return ArrayH},setArrayH:function(a){ArrayH=a},getArrayI:function(){return ArrayI},setArrayI:function(a){ArrayI=a},getArrayJ:function(){return ArrayJ},setArrayJ:function(a){ArrayJ=a},getArrayK:function(){return ArrayK},setArrayK:function(a){ArrayK=a},getArrayL:function(){return ArrayL},setArrayL:function(a){ArrayL=a},getArrayM:function(){return ArrayM},setArrayM:function(a){ArrayM=a},getArrayN:function(){return ArrayN},setArrayN:function(a){ArrayN=a},getArrayO:function(){return ArrayO},setArrayO:function(a){ArrayO=a},getArrayP:function(){return ArrayP},setArrayP:function(a){ArrayP=a},getArrayQ:function(){return ArrayQ},setArrayQ:function(a){ArrayQ=a},getArrayR:function(){return ArrayR},setArrayR:function(a){ArrayR=a},getArrayS:function(){return ArrayS},setArrayS:function(a){ArrayS=a},getArrayT:function(){return ArrayT},setArrayT:function(a){ArrayT=a},getArrayU:function(){return ArrayU},setArrayU:function(a){ArrayU=a},getArrayV:function(){return ArrayV},setArrayV:function(a){ArrayV=a},getArrayW:function(){return ArrayW},setArrayW:function(a){ArrayW=a},getArrayX:function(){return ArrayX},setArrayX:function(a){ArrayX=a},getArrayY:function(){return ArrayY},setArrayY:function(a){ArrayY=a},getArrayZ:function(){return ArrayZ},setArrayZ:function(a){ArrayZ=a},getArray0:function(){return Array0},setArray0:function(a){Array0=a}}}),SDM.angular.factory("DataService",["$http","sharedProperties",function($http,sharedProperties){"use strict";var pub={},eventListeners={movieClicked:[]};return pub.addEventListener=function(a,b){eventListeners[a].push(b)},pub.movieClicked=function(a){for(var b=0;b<eventListeners.movieClicked.length;b++)eventListeners.movieClicked[b](a)},pub.Reset=function(){var a=localStorage.getItem("departement"),b=localStorage.getItem("region");""!=b&&null!=b?(sharedProperties.setLocalisation(b),sharedProperties.setfiltreRegion("1")):""!=a&&null!=a?(sharedProperties.setLocalisation(a),sharedProperties.setfiltreRegion("1")):(sharedProperties.setInfoDep(""),sharedProperties.setfiltreRegion("0"));var c=document.querySelector(".navbar-fixed .page>.searchbar~.page-content, .navbar-fixed>.searchbar~.page-content, .navbar-through .page>.searchbar~.page-content, .navbar-through>.searchbar~.page-content");c.style.padding="60px 0"},pub.ResetTab=function(){sharedProperties.setbuttonFav(0),sharedProperties.setbuttonNew(0),sharedProperties.setbuttonSearch(0),sharedProperties.setshowSearch("0")},pub.ResetTitre=function(){var a=localStorage.getItem("departement"),b=localStorage.getItem("region");""!=b&&null!=b?sharedProperties.setInfoDep("dans votre région"):""!=a&&null!=a?sharedProperties.setInfoDep("dans le "+a):sharedProperties.setInfoDep("")},pub.NbTotal=function(a,b){var c=b-86400,d=0;return angular.forEach(a,function(a,b){var e=a.timestamp;e>c&&d++}),d},pub.NbFiltre=function(a){var b=Math.round((new Date).getTime()/1e3),c=b-86400,d=0,e=localStorage.getItem("departement"),f=localStorage.getItem("region");return""!=e&&null!=e?angular.forEach(a,function(a,b){var f=(""+a.departement).toLowerCase();f.indexOf(e)!==-1&&a.timestamp>c&&d++}):""!=f&&null!=f&&angular.forEach(a,function(a,b){var e=(""+a.region).toLowerCase();e.indexOf(f)!==-1&&a.timestamp>c&&d++}),d},pub.InitCalendar=function(destroy){var listdate=pub.GetDate(),DateEvent=[];angular.forEach(listdate,function(a){DateEvent.push(a.event)});var $$=Dom7,monthNames=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Decembre"],calendarInline=SDM.fw7.app.calendar({container:"#calendar-inline-container",dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],weekHeader:!0,dateFormat:"dd/MM/yyyy",header:!1,footer:!1,toolbarTemplate:'<div class="toolbar calendar-custom-toolbar"><div class="toolbar-inner"><div class="left"><a href="#" class="link icon-only"><i class="icon icon-back"></i></a></div><div class="center"></div><div class="right"><a href="#" class="link icon-only"><i class="icon icon-forward"></i></a></div></div></div>',onOpen:function(a){$$(".calendar-custom-toolbar .center").text(monthNames[a.currentMonth]+", "+a.currentYear),$$(".calendar-custom-toolbar .left .link").on("click",function(){calendarInline.prevMonth()}),$$(".calendar-custom-toolbar .right .link").on("click",function(){calendarInline.nextMonth()})},onMonthYearChangeStart:function(a){$$(".calendar-custom-toolbar .center").text(monthNames[a.currentMonth]+", "+a.currentYear)},events:eval(DateEvent),onDayClick:function(a,b,c,d,e){var f=pub.GetMonthBis(d),g=pub.FormatDay(e),h=g+" "+f+" "+c;localStorage.setItem("date",h);SDM.fw7.app.mainView.router.loadPage("#Liste-date")}})},pub.FormatDay=function(a){var b=a;return a<10&&(b="0"+b),b},pub.IsFav=function(a){var b=localStorage.getItem(a);if("1"===b||"10"===b)return 1},pub.IsNew=function(a){var b=localStorage.getItem(a);if("new"===b||"10"===b)return 1},pub.FuncDate=function(a){if(a)var b=a.split(" "),c=b[1],d=pub.GetMonth(b[2]),e=b[3],f=new Date(e,d,c);return f},pub.GetMonth=function(a){switch(a.toLowerCase()){case"janvier":return"0";case"février":return"1";case"mars":return"2";case"avril":return"3";case"mai":return"4";case"juin":return"5";case"juillet":return"6";case"août":return"7";case"septembre":return"8";case"octobre":return"9";case"novembre":return"10";case"décembre":return"11"}},pub.GetMonthBis=function(a){switch(a.toLowerCase()){case"0":return"janvier";case"1":return"février";case"2":return"mars";case"3":return"avril";case"4":return"mai";case"5":return"juin";case"6":return"juillet";case"7":return"août";case"8":return"septembre";case"9":return"octobre";case"10":return"novembre";case"11":return"décembre"}},pub.GetDate=function(){var a=Math.round((new Date).getTime()/1e3);a-=126400;var b=localStorage.getItem("json"),b=JSON.parse(b),c=localStorage.getItem("departement"),d=localStorage.getItem("region"),e=[];""!=c&&null!=c&&angular.forEach(b,function(b,d){var f=b.timestamp;a<f&&b.departement===c&&e.push({value:b.date,event:pub.FuncDate(b.date)})}),""!=d&&null!=d&&angular.forEach(b,function(b,c){var f=b.timestamp;a<f&&b.region===d&&e.push({value:b.date,event:pub.FuncDate(b.date)})}),""!==d&&null!==d||""!==c&&null!==c||angular.forEach(b,function(b,c){var d=b.timestamp;a<d&&e.push({value:b.date,event:pub.FuncDate(b.date)})});var f=[],g={};return angular.forEach(e,function(a){g[a.value]||(f.push(a),g[a.value]=a)}),f},pub.InitNew=function(){var a=localStorage.getItem("raz");if("1"===a){var b=localStorage.getItem("RazAuto");"1"===b&&pub.EraseNew()}localStorage.setItem("RazAuto","0")},pub.DeleteFav=function(a){var b=localStorage.getItem(a);if("10"===b){localStorage.setItem(a,"new")}else{localStorage.removeItem(a)}var e=sharedProperties.getCountFav,f=e()-1;sharedProperties.setCountFav(f)},pub.EraseNew=function(a){for(var b=0,c=localStorage.length;b<=c;++b){var d=localStorage.getItem(localStorage.key(b)),e=localStorage.key(b);if("json"!=e&&"date"!=e&&"raz"!=e&&"region"!=e&&"departement"!=e&&"version"!=e&&"RazAuto"!=e&&("new"===d&&(localStorage.removeItem(e),pub.EraseNew()),"10"===d)){localStorage.setItem(e,"1");pub.EraseNew()}}},pub.AddFav=function(a){var b=localStorage.getItem(a);if("new"===b){localStorage.setItem(a,"10")}else{localStorage.setItem(a,"1")}var d=sharedProperties.getCountFav,e=d()+1;sharedProperties.setCountFav(e)},pub.ListeGroupe=function(){var a=localStorage.getItem("json"),a=JSON.parse(a),b=[],c=[];angular.forEach(a,function(a,d){b.indexOf(a.groupe_1)<0&&b.push({name:a.groupe_1}),a.groupe_2&&b.indexOf(a.groupe_2)<0&&b.push({name:a.groupe_2}),a.groupe_3&&b.indexOf(a.groupe_3)<0&&b.push({name:a.groupe_3}),a.groupe_4&&b.indexOf(a.groupe_4)<0&&b.push({name:a.groupe_4}),a.groupe_5&&b.indexOf(a.groupe_5)<0&&b.push({name:a.groupe_5}),c.push({value:a.date,event:pub.FuncDate(a.date)})});var d=[],e={};angular.forEach(b,function(a){e[a.name]||(d.push(a),e[a.name]=a)});var f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[],s=[],t=[],u=[],v=[],w=[],x=[],y=[],z=[],A=[],B=[],C=[],D=[],E=[],F=[];angular.forEach(d,function(a){var b=a.name.substring(0,1);switch(b.toLowerCase()){case"a":f.push(a);break;case"b":g.push(a);break;case"c":h.push(a);break;case"d":i.push(a);break;case"e":j.push(a);break;case"f":k.push(a);break;case"g":l.push(a);break;case"h":m.push(a);break;case"i":n.push(a);break;case"j":o.push(a);break;case"k":p.push(a);break;case"l":q.push(a);break;case"m":r.push(a);break;case"n":s.push(a);break;case"o":t.push(a);break;case"p":u.push(a);break;case"q":v.push(a);break;case"r":w.push(a);break;case"s":x.push(a);break;case"t":y.push(a);break;case"u":z.push(a);break;case"v":A.push(a);break;case"w":B.push(a);break;case"x":C.push(a);break;case"y":D.push(a);break;case"z":E.push(a);break;default:F.push(a)}}),sharedProperties.setArrayA(f),sharedProperties.setArrayB(g),sharedProperties.setArrayC(h),sharedProperties.setArrayD(i),sharedProperties.setArrayE(j),sharedProperties.setArrayF(k),sharedProperties.setArrayG(l),sharedProperties.setArrayH(m),sharedProperties.setArrayI(n),sharedProperties.setArrayJ(o),sharedProperties.setArrayK(p),sharedProperties.setArrayL(q),sharedProperties.setArrayM(r),sharedProperties.setArrayN(s),sharedProperties.setArrayO(t),sharedProperties.setArrayP(u),sharedProperties.setArrayQ(v),sharedProperties.setArrayR(w),sharedProperties.setArrayS(x),sharedProperties.setArrayT(y),sharedProperties.setArrayU(z),sharedProperties.setArrayV(A),sharedProperties.setArrayW(B),sharedProperties.setArrayX(C),sharedProperties.setArrayY(D),sharedProperties.setArrayZ(E),sharedProperties.setArray0(F),sharedProperties.setname("A")},pub}]);